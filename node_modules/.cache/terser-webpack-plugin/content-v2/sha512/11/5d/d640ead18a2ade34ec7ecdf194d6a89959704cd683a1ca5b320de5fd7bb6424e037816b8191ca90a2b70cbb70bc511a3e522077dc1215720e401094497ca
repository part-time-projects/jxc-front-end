{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-6958c332\",\"chunk-6958c332\",\"chunk-2d0e8ba8\",\"chunk-2d21a756\"],{\"06d0\":function(e,t,a){},\"33e3\":function(e,t,a){\"use strict\";a.r(t),a.d(t,\"billModalMixin\",(function(){return i}));var r=a(\"e2e0\"),l=a(\"0fea\"),i={data:function(){return{action:\"\",spans:{labelCol1:{span:2},wrapperCol1:{span:22},labelCol1_5:{span:3},wrapperCol1_5:{span:21},labelCol2:{span:4},wrapperCol2:{span:20},labelCol3:{span:6},wrapperCol3:{span:18},labelCol6:{span:12},wrapperCol6:{span:12}}}},computed:{readOnly:function(){return\"add\"!==this.action&&\"edit\"!==this.action}},methods:{onEntryAdded:function(e){var t=e.row,a=e.target,r=a.getValuesSync({validate:!1}),l=r.values,i=0,o=!0,s=!1,n=void 0;try{for(var c,d=l[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var u=c.value,p=Number(u[\"entryNo\"]);!isNaN(p)&&p>i&&(i=p)}}catch(m){s=!0,n=m}finally{try{o||null==d.return||d.return()}finally{if(s)throw n}}i+=this.entryNoStep||10,a.setValues([{rowKey:t.id,values:{entryNo:i}}])},handleSave:function(){this.handleOk()},handleSubmit:function(){var e=this;this.form.setFieldsValue({billProcStatus:\"13\"}),this.getAllTable().then((function(t){return Object(r[\"d\"])(e.form,t)})).then((function(t){if(\"function\"!==typeof e.classifyIntoFormData)throw e.throwNotFunction(\"classifyIntoFormData\");var a=e.classifyIntoFormData(t);return e.request(a)})).catch((function(t){e.form.setFieldsValue({billProcStatus:\"12\"}),t.error===r[\"b\"]&&(e.activeKey=null==t.index?e.activeKey:e.refKeys[t.index])}))},handleApproved:function(){var e=this;Object(l[\"j\"])(e.url.approve,{id:e.model.id}).then((function(t){t.success?(e.$message.success(t.message),e.$emit(\"ok\"),e.close()):e.$message.warning(t.message)}))}}}},\"88bc\":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,l=\"[object Arguments]\",i=\"[object Function]\",o=\"[object GeneratorFunction]\",s=\"[object Symbol]\",n=\"object\"==typeof t&&t&&t.Object===Object&&t,c=\"object\"==typeof self&&self&&self.Object===Object&&self,d=n||c||Function(\"return this\")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function p(e,t){var a=-1,r=e?e.length:0,l=Array(r);while(++a<r)l[a]=t(e[a],a,e);return l}function m(e,t){var a=-1,r=t.length,l=e.length;while(++a<r)e[l+a]=t[a];return e}var f=Object.prototype,b=f.hasOwnProperty,v=f.toString,y=d.Symbol,h=f.propertyIsEnumerable,w=y?y.isConcatSpreadable:void 0,g=Math.max;function C(e,t,a,r,l){var i=-1,o=e.length;a||(a=j),l||(l=[]);while(++i<o){var s=e[i];t>0&&a(s)?t>1?C(s,t-1,a,r,l):m(l,s):r||(l[l.length]=s)}return l}function O(e,t){return e=Object(e),R(e,t,(function(t,a){return a in e}))}function R(e,t,a){var r=-1,l=t.length,i={};while(++r<l){var o=t[r],s=e[o];a(s,o)&&(i[o]=s)}return i}function N(e,t){return t=g(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,l=g(a.length-t,0),i=Array(l);while(++r<l)i[r]=a[t+r];r=-1;var o=Array(t+1);while(++r<t)o[r]=a[r];return o[t]=i,u(e,this,o)}}function j(e){return A(e)||x(e)||!!(w&&e&&e[w])}function k(e){if(\"string\"==typeof e||V(e))return e;var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}function x(e){return T(e)&&b.call(e,\"callee\")&&(!h.call(e,\"callee\")||v.call(e)==l)}var A=Array.isArray;function S(e){return null!=e&&I(e.length)&&!P(e)}function T(e){return D(e)&&S(e)}function P(e){var t=_(e)?v.call(e):\"\";return t==i||t==o}function I(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=r}function _(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function D(e){return!!e&&\"object\"==typeof e}function V(e){return\"symbol\"==typeof e||D(e)&&v.call(e)==s}var B=N((function(e,t){return null==e?{}:O(e,p(C(t,1),k))}));e.exports=B}).call(this,a(\"c8ba\"))},\"8b08\":function(e,t,a){\"use strict\";function r(e,t,a,r,l,i){if(\"blur\"===e){var o=i.getValuesSync({validate:!1}),s=o.values,n=0,c=!0,d=!1,u=void 0;try{for(var p,m=s[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var f=p.value;if(Number(f[\"entryNo\"])===Number(t)&&++n>=2)return void l(!1,\"${title}不能重复\")}}catch(b){d=!0,u=b}finally{try{c||null==m.return||m.return()}finally{if(d)throw u}}l(!0)}else l()}function l(e,t,a,r,l,i){if(\"blur\"===e){var o=Number(t);if(isNaN(o))l();else{var s=Number(this.form.getFieldValue(\"isRubric\"));0===s&&o<0?l(!1,\"蓝字单${title}不能为负数\"):1===s&&o>0?l(!1,\"红字单${title}不能为正数\"):l(!0)}}else l()}a.r(t),a.d(t,\"validateEntryNo\",(function(){return r})),a.d(t,\"validateByIsRubric\",(function(){return l}))},\"9b86\":function(e,t,a){\"use strict\";a.r(t);var r=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r(\"j-modal\",{attrs:{title:\"采购付款 - \"+t.title,width:t.width,visible:t.visible,confirmLoading:t.confirmLoading,maskClosable:!1,keyboard:!1,forceRender:!0,switchFullscreen:\"\"},on:{cancel:t.handleCancel}},[r(\"template\",{slot:\"footer\"},[\"detail\"!==t.action?r(\"a-button\",{key:\"cancel\",on:{click:t.handleCancel}},[t._v(\"取消\")]):t._e(),t.readOnly?t._e():r(\"a-button\",{key:\"save\",attrs:{type:\"primary\",loading:t.confirmLoading},on:{click:t.handleSave}},[t._v(\"保存\")]),t.readOnly?t._e():r(\"a-button\",{key:\"submit\",attrs:{type:\"primary\",loading:t.confirmLoading},on:{click:t.handleSubmit}},[t._v(\"提交\")]),\"detail\"===t.action?r(\"a-button\",{key:\"close\",attrs:{type:\"primary\"},on:{click:t.handleCancel}},[t._v(\"关闭\")]):t._e(),\"approve\"===t.action?r(\"a-button\",{key:\"approved\",attrs:{type:\"primary\"},on:{click:t.handleApproved}},[t._v(\"审核通过\")]):t._e()],1),r(\"a-spin\",{attrs:{spinning:t.confirmLoading}},[r(\"a-form\",{attrs:{form:t.form}},[r(\"a-row\",[r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"处理状态\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"billProcStatus\",t.validatorRules.billProcStatus],expression:\"['billProcStatus', validatorRules.billProcStatus]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"x_bill_proc_status\"}})],1)],1),r(\"a-col\",{attrs:{span:4}},[r(\"a-form-item\",{attrs:{label:\"是否通过\",labelCol:t.spans.labelCol6,wrapperCol:t.spans.wrapperCol6}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"isApproved\",t.validatorRules.isApproved],expression:\"['isApproved', validatorRules.isApproved]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"yn\"}})],1)],1),r(\"a-col\",{attrs:{span:4}},[r(\"a-form-item\",{attrs:{label:\"是否关闭\",labelCol:t.spans.labelCol6,wrapperCol:t.spans.wrapperCol6}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"isClosed\",t.validatorRules.isClosed],expression:\"['isClosed', validatorRules.isClosed]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"yn\"}})],1)],1),r(\"a-col\",{attrs:{span:4}},[r(\"a-form-item\",{attrs:{label:\"是否作废\",labelCol:t.spans.labelCol6,wrapperCol:t.spans.wrapperCol6}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"isVoided\",t.validatorRules.isVoided],expression:\"['isVoided', validatorRules.isVoided]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"yn\"}})],1)],1),r(\"a-col\",{attrs:{span:4}},[r(\"a\",{staticStyle:{float:\"right\",\"margin-top\":\"10px\"},on:{click:function(){return e.moreStatus=!e.moreStatus}}},[t._v(\"\\n            \"+t._s(t.moreStatus?\"收起\":\"展开\")+\"\\n            \"),r(\"a-icon\",{attrs:{type:t.moreStatus?\"up\":\"down\"}})],1)])],1),r(\"a-row\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.moreStatus,expression:\"moreStatus\"}]},[r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"创建时间\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-date\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"createTime\",t.validatorRules.createTime],expression:\"[ 'createTime', validatorRules.createTime]\"}],staticStyle:{width:\"100%\"},attrs:{readOnly:!0,\"trigger-change\":!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"创建人\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"createBy\",t.validatorRules.createBy],expression:\"['createBy', validatorRules.createBy]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"sys_user,realname,username\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"创建部门\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"sysOrgCode\",t.validatorRules.sysOrgCode],expression:\"['sysOrgCode', validatorRules.sysOrgCode]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"sys_depart,depart_name,org_code\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"生效时间\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-date\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"effectiveTime\",t.validatorRules.effectiveTime],expression:\"[ 'effectiveTime', validatorRules.effectiveTime]\"}],staticStyle:{width:\"100%\"},attrs:{readOnly:!0,showTime:!0,\"trigger-change\":!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"审核人\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"approverId\",t.validatorRules.approverId],expression:\"['approverId', validatorRules.approverId]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"sys_user,realname,username\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"流程\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"flowId\",t.validatorRules.flowId],expression:\"[ 'flowId', validatorRules.flowId]\"}],attrs:{readOnly:!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"修改时间\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-date\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"updateTime\",t.validatorRules.updateTime],expression:\"[ 'updateTime', validatorRules.updateTime]\"}],staticStyle:{width:\"100%\"},attrs:{readOnly:!0,\"trigger-change\":!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"修改人\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"updateBy\",t.validatorRules.updateBy],expression:\"['updateBy', validatorRules.updateBy]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"sys_user,realname,username\"}})],1)],1)],1),r(\"a-row\",[r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"单据编号\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"billNo\",t.validatorRules.billNo],expression:\"[ 'billNo', validatorRules.billNo]\"}],attrs:{readOnly:!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"单据日期\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-date\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"billDate\",t.validatorRules.billDate],expression:\"[ 'billDate', validatorRules.billDate]\"}],staticStyle:{width:\"100%\"},attrs:{readOnly:t.readOnly,\"trigger-change\":!0}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"制单人\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"createBy\",t.validatorRules.createBy],expression:\"['createBy', validatorRules.createBy]\"}],attrs:{disabled:\"\",type:\"list\",\"trigger-change\":!0,dictCode:\"sys_user,realname,username\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"供应商\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"supplierId\",t.validatorRules.supplierId],expression:\"['supplierId', validatorRules.supplierId]\"}],attrs:{disabled:t.readOnly,type:\"list\",\"trigger-change\":!0,dictCode:\"bas_supplier,name,id\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"是否红字\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"j-dict-select-tag\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"isRubric\",t.validatorRules.isRubric],expression:\"['isRubric', validatorRules.isRubric]\"}],attrs:{disabled:t.readOnly,type:\"list\",\"trigger-change\":!0,dictCode:\"yn\"}})],1)],1),r(\"a-col\",{attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"金额\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"amt\",t.validatorRules.amt],expression:\"['amt', validatorRules.amt]\"}],staticStyle:{width:\"100%\"},attrs:{disabled:\"\"}})],1)],1),r(\"a-col\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"detail\"===t.action&&\"201\"===t.model.paymentType,expression:\"action==='detail' && model.paymentType === '201'\"}],attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"已抵扣预付\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"deductedAmt\",t.validatorRules.deductedAmt],expression:\"['deductedAmt', validatorRules.deductedAmt]\"}],staticStyle:{width:\"100%\"},attrs:{disabled:\"\"}})],1)],1),r(\"a-col\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"detail\"===t.action,expression:\"action==='detail'\"}],attrs:{span:8}},[r(\"a-form-item\",{attrs:{label:\"已核销金额\",labelCol:t.spans.labelCol3,wrapperCol:t.spans.wrapperCol3}},[r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"checkedAmt\",t.validatorRules.checkedAmt],expression:\"['checkedAmt', validatorRules.checkedAmt]\"}],staticStyle:{width:\"100%\"},attrs:{disabled:\"\"}})],1)],1)],1),r(\"a-row\",[r(\"a-col\",{attrs:{span:24}},[r(\"a-form-item\",{attrs:{label:\"备注\",labelCol:t.spans.labelCol1,wrapperCol:t.spans.wrapperCol1}},[r(\"a-textarea\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"remark\",t.validatorRules.remark],expression:\"['remark', validatorRules.remark]\"}],attrs:{readOnly:t.readOnly,rows:\"1\",autoSize:\"\"}})],1)],1),r(\"a-col\",{attrs:{span:24}},[r(\"a-form-item\",{attrs:{label:\"附件\",labelCol:t.spans.labelCol1,wrapperCol:t.spans.wrapperCol1}},[r(\"j-upload\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"attachment\",t.validatorRules.attachment],expression:\"['attachment', validatorRules.attachment]\"}],attrs:{disabled:t.readOnly,\"trigger-change\":!0}})],1)],1)],1)],1),r(\"a-tabs\",{on:{change:t.handleChangeTabs},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:\"activeKey\"}},[r(\"a-tab-pane\",{key:t.refKeys[0],attrs:{tab:\"付款明细\",forceRender:!0}},[r(\"j-editable-table\",{ref:t.refKeys[0],attrs:{disabled:t.readOnly,loading:t.finPaymentEntryTable.loading,columns:t.finPaymentEntryTable.columns,dataSource:t.finPaymentEntryTable.dataSource,maxHeight:300,rowNumber:!1,rowSelection:!0,actionButton:!t.readOnly},on:{added:t.onEntryAdded,deleted:t.onEntryDeleted,valueChange:t.onValueChange}})],1)],1)],1)],2)},l=[],i=a(\"88bc\"),o=a.n(i),s=a(\"e2e0\"),n=a(\"d0ed\"),c=a(\"2dab\"),d=a(\"cf74\"),u=a(\"7b16\"),p=a(\"0fea\"),m=a(\"33e3\"),f=a(\"bc32\"),b=a(\"8b08\");function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){h(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var w={name:\"PurPaymentModal\",mixins:[n[\"a\"],m[\"billModalMixin\"]],components:{JDate:c[\"default\"],JUpload:d[\"default\"],JDictSelectTag:u[\"default\"]},data:function(){return{width:\"1200px\",moreStatus:!1,addDefaultRowNum:1,validatorRules:{billNo:{rules:[{required:!0,message:\"请输入单据编号!\"}]},billDate:{rules:[{required:!0,message:\"请输入单据日期!\"}]},supplierId:{rules:[{required:!0,message:\"请选择供应商!\"}]},amt:{rules:[]},deductedAmt:{rules:[]},checkedAmt:{rules:[]},attachment:{rules:[]},remark:{rules:[]},billProcStatus:{rules:[]},isApproved:{rules:[]},isClosed:{rules:[]},isVoided:{rules:[]},effectiveTime:{rules:[]},approverId:{rules:[]},flowId:{rules:[]},createTime:{rules:[]},createBy:{rules:[]},sysOrgCode:{rules:[]},updateTime:{rules:[]},updateBy:{rules:[]}},refKeys:[\"finPaymentEntry\"],tableKeys:[\"finPaymentEntry\"],activeKey:\"finPaymentEntry\",finPaymentEntryTable:{loading:!1,dataSource:[],columns:[{title:\"分录号\",key:\"entryNo\",type:s[\"a\"].inputNumber,width:\"60px\",placeholder:\"请输入${title}\",defaultValue:\"\",validateRules:[{required:!0,message:\"${title}不能为空\"},{pattern:/^[1-9]\\d*$/,message:\"请输入零以上的正整数\"},{handler:b[\"validateEntryNo\"]}]},{title:\"源单分录号\",key:\"sourceEntryNo\",type:s[\"a\"].input,width:\"180px\",defaultValue:\"\"},{title:\"结算方式\",key:\"settleMethod\",type:s[\"a\"].select,dictCode:\"x_settle_method\",width:\"150px\",defaultValue:\"\",options:[],validateRules:[{required:!0,message:\"${title}不能为空\"}]},{title:\"资金账户\",key:\"bankAccountId\",type:s[\"a\"].select,dictCode:\"bas_bank_account,account_no,id\",width:\"260px\",defaultValue:\"\",options:[]},{title:\"金额\",key:\"amt\",type:s[\"a\"].inputNumber,width:\"120px\",defaultValue:\"\",validateRules:[{required:!0,message:\"${title}不能为空\"},{handler:b[\"validateByIsRubric\"]}]},{title:\"备注\",key:\"remark\",type:s[\"a\"].input,width:\"200px\",defaultValue:\"\"},{title:\"备注2\",key:\"remark2\",type:s[\"a\"].input,width:\"200px\",defaultValue:\"\"},{title:\"备注3\",key:\"remark3\",type:s[\"a\"].input,width:\"200px\",defaultValue:\"\"}]},url:{add:\"/finance/finPayment/add\",edit:\"/finance/finPayment/edit\",approve:\"/finance/finPayment/approve\",finPaymentEntry:{list:\"/finance/finPayment/queryFinPaymentEntryByMainId\"}}}},methods:{getAllTable:function(){var e=this,t=this.tableKeys.map((function(t){return Object(s[\"c\"])(e,t)}));return Promise.all(t)},addInit:function(){this.model.paymentType=\"202\",this.model.isRubric=0,this.model.billProcStatus=\"12\",this.model.amt=0,this.model.deductedAmt=0,this.model.checkedAmt=0;var e=\"/sys/fillRule/executeRuleByCode/\",t=\"payment_bill_no\",a=this;Object(p[\"j\"])(e+t,{}).then((function(e){e.success&&a.$nextTick((function(){a.form.setFieldsValue({billNo:e.result,billDate:Object(f[\"getFormatDate\"])()})}))}))},editAfter:function(){var e=this;\"add\"===this.action&&this.addInit();var t=o()(this.model,\"billNo\",\"billDate\",\"supplierId\",\"isRubric\",\"amt\",\"deductedAmt\",\"checkedAmt\",\"attachment\",\"remark\",\"billProcStatus\",\"isApproved\",\"isClosed\",\"isVoided\",\"effectiveTime\",\"approverId\",\"flowId\",\"createTime\",\"createBy\",\"sysOrgCode\",\"updateTime\",\"updateBy\");if(this.$nextTick((function(){e.form.setFieldsValue(t)})),this.model.id){var a={id:this.model.id};this.requestSubTableData(this.url.finPaymentEntry.list,a,this.finPaymentEntryTable)}},classifyIntoFormData:function(e){var t=Object.assign(this.model,e.formValue);return y({},t,{finPaymentEntryList:e.tablesValue[0].values})},validateError:function(e){this.$message.error(e)},popupCallback:function(e){this.form.setFieldsValue(o()(e,\"billNo\",\"billDate\",\"supplierId\",\"isRubric\",\"amt\",\"deductedAmt\",\"checkedAmt\",\"attachment\",\"remark\",\"billProcStatus\",\"isApproved\",\"isClosed\",\"isVoided\",\"effectiveTime\",\"approverId\",\"flowId\",\"createTime\",\"createBy\",\"sysOrgCode\",\"updateTime\",\"updateBy\"))},onEntryDeleted:function(e){this.calcTotalAmt()},onValueChange:function(e){e.type,e.row;var t=e.column;e.value,e.target;\"amt\"===t.key&&this.calcTotalAmt()},calcTotalAmt:function(){var e=this.$refs.finPaymentEntry.getValuesSync({validate:!1}),t=(e.error,e.values),a=0,r=!0,l=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var n=o.value,c=Number(n[\"amt\"]);isNaN(c)||(a+=c)}}catch(u){l=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(l)throw i}}var d=this;d.$nextTick((function(){d.form.setFieldsValue({amt:a})}))}}},g=w,C=(a(\"c2ca\"),a(\"2877\")),O=Object(C[\"a\"])(g,r,l,!1,null,\"4e30760c\",null);t[\"default\"]=O.exports},bc32:function(e,t,a){\"use strict\";function r(){var e=new Date,t=\"-\",a=e.getFullYear(),r=e.getMonth()+1,l=e.getDate();r>=1&&r<=9&&(r=\"0\"+r),l>=0&&l<=9&&(l=\"0\"+l);var i=a+t+r+t+l;return i}a.r(t),a.d(t,\"getFormatDate\",(function(){return r})),String.prototype.format=function(){var e=arguments;return this.replace(/\\{(\\d+)\\}/g,(function(t,a){return e.length>a?e[a]:\"\"}))}},c2ca:function(e,t,a){\"use strict\";var r=a(\"06d0\"),l=a.n(r);l.a},d0ed:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return o}));var r=a(\"7550\"),l=a(\"e2e0\"),i=a(\"0fea\"),o={components:{JEditableTable:r[\"default\"]},data:function(){return{title:\"操作\",visible:!1,form:this.$form.createForm(this),confirmLoading:!1,model:{},labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}},methods:{getAllTable:function(){var e=this;if(!(this.refKeys instanceof Array))throw this.throwNotArray(\"refKeys\");var t=this.refKeys.map((function(t){return Object(l[\"c\"])(e,t)}));return Promise.all(t)},eachAllTable:function(e){this.getAllTable().then((function(t){t.forEach((function(t,a){\"function\"===typeof e&&e(t,a)}))}))},add:function(){\"function\"===typeof this.addBefore&&this.addBefore();var e=this.addDefaultRowNum;\"number\"!==typeof e&&(e=1),this.eachAllTable((function(t){t.add(e)})),\"function\"===typeof this.addAfter&&this.addAfter(this.model),this.edit({})},edit:function(e){\"function\"===typeof this.editBefore&&this.editBefore(e),this.visible=!0,this.activeKey=this.refKeys[0],this.form.resetFields(),this.model=Object.assign({},e),\"function\"===typeof this.editAfter&&this.editAfter(this.model)},close:function(){this.visible=!1,this.eachAllTable((function(e){e.initialize()})),this.$emit(\"close\")},requestSubTableData:function(e,t,a,r){a.loading=!0,Object(i[\"c\"])(e,t).then((function(e){var t=e.result,l=[];t&&(Array.isArray(t)?l=t:Array.isArray(t.records)&&(l=t.records)),a.dataSource=l,\"function\"===typeof r&&r(e)})).finally((function(){a.loading=!1}))},request:function(e){var t=this,a=this.url.add,r=\"post\";this.model.id&&(a=this.url.edit,r=\"put\"),this.confirmLoading=!0,Object(i[\"h\"])(a,e,r).then((function(e){e.success?(t.$message.success(e.message),t.$emit(\"ok\"),t.close()):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))},handleChangeTabs:function(e){Object(l[\"c\"])(this,e).then((function(e){e.resetScrollTop()}))},handleCancel:function(){this.close()},handleOk:function(){var e=this;this.getAllTable().then((function(t){return Object(l[\"d\"])(e.form,t)})).then((function(t){if(\"function\"!==typeof e.classifyIntoFormData)throw e.throwNotFunction(\"classifyIntoFormData\");var a=e.classifyIntoFormData(t);return e.request(a)})).catch((function(t){t.error===l[\"b\"]&&(e.activeKey=null==t.index?e.activeKey:e.refKeys[t.index])}))},throwNotFunction:function(e){return\"\".concat(e,\" 未定义或不是一个函数\")},throwNotArray:function(e){return\"\".concat(e,\" 未定义或不是一个数组\")}}}}}]);","extractedComments":[]}