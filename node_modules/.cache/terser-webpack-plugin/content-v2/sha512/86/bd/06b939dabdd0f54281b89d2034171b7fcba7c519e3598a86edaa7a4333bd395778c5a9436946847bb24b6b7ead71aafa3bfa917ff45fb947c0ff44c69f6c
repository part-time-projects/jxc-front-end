{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-d4c0b7fa\"],{\"7e09\":function(e,t,a){\"use strict\";var r=a(\"d1f6\"),n=a.n(r);n.a},ca7e:function(e,t,a){\"use strict\";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-card\",{staticStyle:{height:\"100%\"},attrs:{bordered:!1}},[a(\"div\",{staticClass:\"table-page-search-wrapper\"},[a(\"a-form\",{attrs:{layout:\"inline\"}},[e.queryInfo&&e.queryInfo.length>0?a(\"a-row\",{attrs:{gutter:24}},[e._l(e.queryInfo,(function(t,r){return[\"1\"===t.hidden?[t.view.indexOf(\"Date\")>=0?a(\"a-col\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.toggleSearchStatus,expression:\"toggleSearchStatus\"}],key:\"query\"+r,attrs:{md:12,sm:16}},[a(\"onl-cgreport-query-form-item\",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a(\"a-col\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.toggleSearchStatus,expression:\"toggleSearchStatus\"}],key:\"query\"+r,attrs:{md:6,sm:8}},[a(\"onl-cgreport-query-form-item\",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]:[t.view.indexOf(\"Date\")>=0?a(\"a-col\",{key:\"query\"+r,attrs:{md:12,sm:16}},[a(\"onl-cgreport-query-form-item\",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a(\"a-col\",{key:\"query\"+r,attrs:{md:6,sm:8}},[a(\"onl-cgreport-query-form-item\",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]]})),a(\"a-col\",{attrs:{md:6,sm:8}},[a(\"span\",{staticClass:\"table-page-search-submitButtons\",staticStyle:{float:\"left\",overflow:\"hidden\"}},[a(\"a-button\",{attrs:{type:\"primary\",icon:\"search\"},on:{click:e.searchByQuery}},[e._v(\"查询\")]),a(\"a-button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"primary\",icon:\"reload\"},on:{click:e.searchReset}},[e._v(\"重置\")]),a(\"a\",{staticStyle:{\"margin-left\":\"8px\"},on:{click:e.handleToggleSearch}},[e._v(\"\\n              \"+e._s(e.toggleSearchStatus?\"收起\":\"展开\")+\"\\n              \"),a(\"a-icon\",{attrs:{type:e.toggleSearchStatus?\"up\":\"down\"}})],1)],1)])],2):e._e()],1)],1),a(\"div\",{staticClass:\"table-operator\",staticStyle:{\"margin-bottom\":\"10px\"}}),a(\"a-table\",{ref:\"table\",staticStyle:{\"min-height\":\"300px\"},attrs:{size:\"middle\",bordered:\"\",rowKey:\"id\",columns:e.table.columns,dataSource:e.table.dataSource,pagination:e.table.pagination,loading:e.table.loading,scroll:e.table.scroll,rowSelection:{fixed:!0,selectedRowKeys:e.table.selectedRowKeys,onChange:e.handleChangeInTableSelect}},on:{change:e.handleChangeInTable},scopedSlots:e._u([e._l(e.fieldHrefSlots,(function(t){return{key:t.slotName,fn:function(r,n){return[a(\"a\",{on:{click:function(a){return e.handleClickFieldHref(t,n)}}},[e._v(e._s(r))])]}}}))],null,!0)}),a(\"a-modal\",e._g(e._b({},\"a-modal\",e.hrefComponent.model,!1),e.hrefComponent.on),[a(e.hrefComponent.is,e._b({tag:\"component\"},\"component\",e.hrefComponent.params,!1))],1)],1)},n=[],o=a(\"b5ef\"),i=a(\"0fea\"),s=a(\"89f2\"),c=a(\"ca00\");function l(e){return m(e)||d(e)||u()}function u(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}function d(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}function m(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var h={name:\"OnlCgreportAutoList\",mixins:[o[\"a\"]],components:{},data:function(){return{queryInfo:[],queryParamsMap:{},selfParam:{},sorter:{column:\"\",order:\"desc\"},dictOptions:{},toggleSearchStatus:!1,reportCode:\"\",description:\"在线报表功能测试页面\",url:{getColumnsAndData:\"/online/cgreport/api/getColumnsAndData/\",getQueryInfo:\"/online/cgreport/api/getQueryInfo/\",getParamsInfo:\"/online/cgreport/api/getParamsInfo/\"},table:{loading:!0,columns:[],dataSource:[],selectedRowKeys:[],selectionRows:[],scroll:{x:!1},pagination:{current:1,pageSize:10,pageSizeOptions:[\"10\",\"20\",\"30\"],showTotal:function(e,t){return t[0]+\"-\"+t[1]+\" 共\"+e+\"条\"},showQuickJumper:!0,showSizeChanger:!0,total:0}},cgreportHeadName:\"\"}},mounted:function(){this.initParamsInfo(),this.initQueryInfo()},watch:{$route:function(){this.initParamsInfo(),this.initQueryInfo()}},computed:{queryParam:{get:function(){return this.queryParamsMap[this.reportCode]},set:function(e){this.$set(this.queryParamsMap,this.reportCode,e)}}},methods:{initParamsInfo:function(){var e=this;if(!this.$route.params.code)return!1;this.reportCode=this.$route.params.code,this.queryParam||(this.queryParam={}),this.selfParam={},Object(i[\"c\"])(\"\".concat(this.url.getParamsInfo).concat(this.reportCode)).then((function(t){if(t.success){if(t.result&&t.result.length>0){var a=!0,r=!1,n=void 0;try{for(var o,i=t.result[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value;e.selfParam[\"self_\"+s.paramName]=e.$route.query[s.paramName]?e.$route.query[s.paramName]:\"\"}}catch(c){r=!0,n=c}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}}}else e.$message.warning(t.message);e.loadData()}))},initQueryInfo:function(){var e=this;if(!this.reportCode)return!1;Object(i[\"c\"])(\"\".concat(this.url.getQueryInfo).concat(this.reportCode)).then((function(t){t.success?e.queryInfo=t.result:e.$message.warning(t.message)}))},loadData:function(e){var t=this;if(!this.reportCode)return!1;1==e&&(this.table.pagination.current=1);var a=this.getQueryParams();this.table.loading=!0,Object(i[\"c\"])(\"\".concat(this.url.getColumnsAndData).concat(this.reportCode),a).then((function(e){if(e.success){var a=e.result,r=a.data,n=a.columns,o=a.cgreportHeadName,i=a.dictOptions,c=a.fieldHrefSlots,u=230;t.dictOptions=i;for(var d=0;d<n.length;d++)n[d].customRender&&function(){var e=n[d].customRender;n[d].customRender=function(a){return a?Object(s[\"c\"])(t.dictOptions[e],a+\"\"):a}}(),n.width=u;t.table.scroll.x=n.length*u,t.table.columns=l(n),t.cgreportHeadName=o,t.fieldHrefSlots=c,r?(t.table.pagination.total=Number(r.total),t.table.dataSource=r.records):(t.table.pagination.total=0,t.table.dataSource=[])}else t.$message.warn(\"查询失败：\"+e.message)})).catch((function(e){t.$message.error(\"查询失败\")})).finally((function(){t.table.loading=!1}))},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.sorter,this.selfParam);return e.pageNo=this.table.pagination.current,e.pageSize=this.table.pagination.pageSize,Object(c[\"d\"])(e)},searchByQuery:function(){this.loadData(1)},searchReset:function(){this.queryParam={},this.loadData(1)},handleToggleSearch:function(){this.toggleSearchStatus=!this.toggleSearchStatus},exportExcel:function(){var e=this,t=this.cgreportHeadName,a={};for(var r in this.$route.query)if(this.$route.query.hasOwnProperty(r)){var n=this.$route.query[r];a[\"self_\"+r]=n||\"\"}Object(i[\"b\"])(\"/online/cgreport/api/exportXls/\".concat(this.reportCode),Object.assign(a,this.queryParam)).then((function(a){if(a)if(\"undefined\"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([a]),t+\".xls\");else{var r=window.URL.createObjectURL(new Blob([a])),n=document.createElement(\"a\");n.style.display=\"none\",n.href=r,n.setAttribute(\"download\",t+\".xls\"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}else e.$message.warning(\"文件下载失败\")}))},handleChangeInTableSelect:function(e,t){this.table.selectedRowKeys=e,this.table.selectionRows=t},handleChangeInTable:function(e,t,a){Object.keys(a).length>0?(this.sorter.column=a.field,this.sorter.order=\"ascend\"==a.order?\"asc\":\"desc\"):(this.sorter.column=null,this.sorter.order=null),this.table.pagination=e,this.loadData()}}},f=h,p=(a(\"7e09\"),a(\"2877\")),g=Object(p[\"a\"])(f,r,n,!1,null,\"0c1b0885\",null);t[\"default\"]=g.exports},d1f6:function(e,t,a){}}]);","extractedComments":[]}