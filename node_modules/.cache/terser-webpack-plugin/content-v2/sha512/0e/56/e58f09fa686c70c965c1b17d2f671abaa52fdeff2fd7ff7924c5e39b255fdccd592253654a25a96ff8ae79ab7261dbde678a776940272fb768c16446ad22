{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4d29aa32\",\"chunk-19c7ca16\"],{\"0380\":function(e,t,a){\"use strict\";var n=a(\"d3bb\"),i=a.n(n);i.a},\"88bc\":function(e,t,a){(function(t){var a=1/0,n=9007199254740991,i=\"[object Arguments]\",r=\"[object Function]\",o=\"[object GeneratorFunction]\",l=\"[object Symbol]\",s=\"object\"==typeof t&&t&&t.Object===Object&&t,d=\"object\"==typeof self&&self&&self.Object===Object&&self,c=s||d||Function(\"return this\")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function h(e,t){var a=-1,n=e?e.length:0,i=Array(n);while(++a<n)i[a]=t(e[a],a,e);return i}function f(e,t){var a=-1,n=t.length,i=e.length;while(++a<n)e[i+a]=t[a];return e}var p=Object.prototype,y=p.hasOwnProperty,m=p.toString,v=c.Symbol,g=p.propertyIsEnumerable,b=v?v.isConcatSpreadable:void 0,x=Math.max;function w(e,t,a,n,i){var r=-1,o=e.length;a||(a=F),i||(i=[]);while(++r<o){var l=e[r];t>0&&a(l)?t>1?w(l,t-1,a,n,i):f(i,l):n||(i[i.length]=l)}return i}function S(e,t){return e=Object(e),C(e,t,(function(t,a){return a in e}))}function C(e,t,a){var n=-1,i=t.length,r={};while(++n<i){var o=t[n],l=e[o];a(l,o)&&(r[o]=l)}return r}function k(e,t){return t=x(void 0===t?e.length-1:t,0),function(){var a=arguments,n=-1,i=x(a.length-t,0),r=Array(i);while(++n<i)r[n]=a[t+n];n=-1;var o=Array(t+1);while(++n<t)o[n]=a[n];return o[t]=r,u(e,this,o)}}function F(e){return K(e)||j(e)||!!(b&&e&&e[b])}function O(e){if(\"string\"==typeof e||P(e))return e;var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}function j(e){return R(e)&&y.call(e,\"callee\")&&(!g.call(e,\"callee\")||m.call(e)==i)}var K=Array.isArray;function D(e){return null!=e&&$(e.length)&&!E(e)}function R(e){return L(e)&&D(e)}function E(e){var t=B(e)?m.call(e):\"\";return t==r||t==o}function $(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=n}function B(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function L(e){return!!e&&\"object\"==typeof e}function P(e){return\"symbol\"==typeof e||L(e)&&m.call(e)==l}var _=k((function(e,t){return null==e?{}:S(e,h(w(t,1),O))}));e.exports=_}).call(this,a(\"c8ba\"))},b098:function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-tree-select\",{staticStyle:{width:\"100%\"},attrs:{allowClear:\"\",labelInValue:\"\",getPopupContainer:function(e){return e.parentNode},disabled:e.disabled,dropdownStyle:{maxHeight:\"400px\",overflow:\"auto\"},placeholder:e.placeholder,loadData:e.asyncLoadTreeData,value:e.treeValue,treeData:e.treeData,multiple:e.multiple},on:{change:e.onChange,search:e.onSearch}})},i=[],r=a(\"0fea\");function o(e){return o=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},o(e)}function l(e){return c(e)||d(e)||s()}function s(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}function d(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var u={name:\"JTreeSelect\",props:{value:{type:String,required:!1},placeholder:{type:String,default:\"请选择\",required:!1},dict:{type:String,default:\"\",required:!1},pidField:{type:String,default:\"pid\",required:!1},pidValue:{type:String,default:\"\",required:!1},disabled:{type:Boolean,default:!1,required:!1},hasChildField:{type:String,default:\"\",required:!1},condition:{type:String,default:\"\",required:!1},multiple:{type:Boolean,default:!1},loadTriggleChange:{type:Boolean,default:!1,required:!1}},data:function(){return{treeValue:null,treeData:[],url:\"/sys/dict/loadTreeData\",view:\"/sys/dict/loadDictItem/\",tableName:\"\",text:\"\",code:\"\"}},watch:{value:function(){this.loadItemByCode()},dict:function(){this.initDictInfo(),this.loadRoot()}},created:function(){var e=this;this.validateProp().then((function(){e.initDictInfo(),e.loadRoot(),e.loadItemByCode()}))},methods:{loadItemByCode:function(){var e=this;this.value&&\"0\"!=this.value?Object(r[\"c\"])(\"\".concat(this.view).concat(this.dict),{key:this.value}).then((function(t){if(t.success){var a=e.value.split(\",\");e.treeValue=t.result.map((function(e,t){return{key:a[t],value:a[t],label:e}})),e.onLoadTriggleChange(t.result[0])}})):this.treeValue=null},onLoadTriggleChange:function(e){!this.multiple&&this.loadTriggleChange&&this.$emit(\"change\",this.value,e)},initDictInfo:function(){var e=this.dict.split(\",\");this.tableName=e[0],this.text=e[1],this.code=e[2]},asyncLoadTreeData:function(e){var t=this;return new Promise((function(a){if(e.$vnode.children)a();else{var n=e.$vnode.key,i={pid:n,tableName:t.tableName,text:t.text,code:t.code,pidField:t.pidField,hasChildField:t.hasChildField,condition:t.condition};Object(r[\"c\"])(t.url,i).then((function(e){if(e.success){var i=!0,r=!1,o=void 0;try{for(var s,d=e.result[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var c=s.value;c.value=c.key,0==c.leaf?c.isLeaf=!1:1==c.leaf&&(c.isLeaf=!0)}}catch(u){r=!0,o=u}finally{try{i||null==d.return||d.return()}finally{if(r)throw o}}t.addChildren(n,e.result,t.treeData),t.treeData=l(t.treeData)}a()}))}}))},addChildren:function(e,t,a){if(a&&a.length>0){var n=!0,i=!1,r=void 0;try{for(var o,l=a[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var s=o.value;if(s.key==e){t&&0!=t.length?s.children=t:s.isLeaf=!0;break}this.addChildren(e,t,s.children)}}catch(d){i=!0,r=d}finally{try{n||null==l.return||l.return()}finally{if(i)throw r}}}},loadRoot:function(){var e=this,t={pid:this.pidValue,tableName:this.tableName,text:this.text,code:this.code,pidField:this.pidField,hasChildField:this.hasChildField,condition:this.condition};Object(r[\"c\"])(this.url,t).then((function(t){if(t.success&&t.result){var a=!0,n=!1,i=void 0;try{for(var r,o=t.result[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var s=r.value;s.value=s.key,0==s.leaf?s.isLeaf=!1:1==s.leaf&&(s.isLeaf=!0)}}catch(d){n=!0,i=d}finally{try{a||null==o.return||o.return()}finally{if(n)throw i}}e.treeData=l(t.result)}}))},onChange:function(e){e?e instanceof Array?(this.$emit(\"change\",e.map((function(e){return e.value})).join(\",\")),this.treeValue=e):(this.$emit(\"change\",e.value,e.label),this.treeValue=e):(this.$emit(\"change\",\"\"),this.treeValue=null)},onSearch:function(e){},getCurrTreeData:function(){return this.treeData},validateProp:function(){var e=this,t=this.condition;return new Promise((function(a,n){if(t)try{var i=JSON.parse(t);\"object\"==o(i)&&i?a():(e.$message.error(\"组件JTreeSelect-condition传值有误，需要一个json字符串!\"),n())}catch(r){e.$message.error(\"组件JTreeSelect-condition传值有误，需要一个json字符串!\"),n()}else a()}))}},model:{prop:\"value\",event:\"change\"}},h=u,f=a(\"2877\"),p=Object(f[\"a\"])(h,n,i,!1,null,null,null);t[\"default\"]=p.exports},d3bb:function(e,t,a){},ddf2:function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-card\",{attrs:{bordered:!1}},[a(\"div\",{staticClass:\"table-operator\"},[a(\"a-button\",{attrs:{type:\"primary\",icon:\"plus\"},on:{click:e.handleAdd}},[e._v(\"新增\")]),e.selectedRowKeys.length>0?a(\"a-dropdown\",[a(\"a-menu\",{attrs:{slot:\"overlay\"},slot:\"overlay\"},[a(\"a-menu-item\",{key:\"1\",on:{click:e.batchDel}},[a(\"a-icon\",{attrs:{type:\"delete\"}}),e._v(\"删除\")],1)],1),a(\"a-button\",{staticStyle:{\"margin-left\":\"8px\"}},[e._v(\" 批量操作 \"),a(\"a-icon\",{attrs:{type:\"down\"}})],1)],1):e._e()],1),a(\"div\",[a(\"div\",{staticClass:\"ant-alert ant-alert-info\",staticStyle:{\"margin-bottom\":\"16px\"}},[a(\"i\",{staticClass:\"anticon anticon-info-circle ant-alert-icon\"}),e._v(\" 已选择 \"),a(\"a\",{staticStyle:{\"font-weight\":\"600\"}},[e._v(e._s(e.selectedRowKeys.length))]),e._v(\"项\\n      \"),a(\"a\",{staticStyle:{\"margin-left\":\"24px\"},on:{click:e.onClearSelected}},[e._v(\"清空\")])]),a(\"a-table\",e._b({ref:\"table\",attrs:{size:\"middle\",rowKey:\"id\",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,expandedRowKeys:e.expandedRowKeys},on:{change:e.handleTableChange,expand:e.handleExpand},scopedSlots:e._u([{key:\"action\",fn:function(t,n){return a(\"span\",{},[a(\"a\",{on:{click:function(t){return e.handleEdit(n)}}},[e._v(\"编辑\")]),a(\"a-divider\",{attrs:{type:\"vertical\"}}),a(\"a-popconfirm\",{attrs:{title:\"确定删除吗?\"},on:{confirm:function(){return e.handleDelete(n)}}},[a(\"a\",[e._v(\"删除\")])]),a(\"a-divider\",{attrs:{type:\"vertical\"}}),a(\"a\",{on:{click:function(t){return e.handleAddSub(n)}}},[e._v(\"添加下级\")])],1)}}])},\"a-table\",e.tableProps,!1))],1),a(\"sysCategory-modal\",{ref:\"modalForm\",on:{ok:e.modalFormOk}})],1)},i=[],r=a(\"a34a\"),o=a.n(r),l=a(\"0fea\"),s=a(\"b65a\"),d=a(\"f1cf\");function c(e,t,a,n,i,r,o){try{var l=e[r](o),s=l.value}catch(d){return void a(d)}l.done?t(s):Promise.resolve(s).then(n,i)}function u(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var r=e.apply(t,a);function o(e){c(r,n,i,o,l,\"next\",e)}function l(e){c(r,n,i,o,l,\"throw\",e)}o(void 0)}))}}function h(e){return y(e)||p(e)||f()}function f(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}function p(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}function y(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var m={name:\"SysCategoryList\",mixins:[s[\"a\"]],components:{SysCategoryModal:d[\"default\"]},data:function(){return{description:\"分类字典管理页面\",columns:[{title:\"分类名称\",align:\"left\",dataIndex:\"name\"},{title:\"分类编码\",align:\"left\",dataIndex:\"code\"},{title:\"操作\",dataIndex:\"action\",align:\"center\",scopedSlots:{customRender:\"action\"}}],url:{list:\"/sys/category/rootList\",childList:\"/sys/category/childList\",delete:\"/sys/category/delete\",deleteBatch:\"/sys/category/deleteBatch\",exportXlsUrl:\"/sys/category/exportXls\",importExcelUrl:\"sys/category/importExcel\"},expandedRowKeys:[],hasChildrenField:\"hasChild\",pidField:\"pid\",dictOptions:{},subExpandedKeys:[]}},computed:{importExcelUrl:function(){return\"\".concat(window._CONFIG[\"domianURL\"],\"/\").concat(this.url.importExcelUrl)},tableProps:function(){var e=this;return{rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:function(t){return e.selectedRowKeys=t}}}}},methods:{loadData:function(e){var t=this;1==e&&(this.ipagination.current=1),this.loading=!0,this.expandedRowKeys=[];var a=this.getQueryParams();return new Promise((function(e){Object(l[\"c\"])(t.url.list,a).then((function(a){if(a.success){var n=a.result;Number(n.total)>0?(t.ipagination.total=Number(n.total),t.dataSource=t.getDataByResult(a.result.records),e()):(t.ipagination.total=0,t.dataSource=[])}else t.$message.warning(a.message);t.loading=!1}))}))},getDataByResult:function(e){var t=this;return e.map((function(e){if(\"1\"==e[t.hasChildrenField]){var a={id:e.id+\"_loadChild\",name:\"loading...\",isLoading:!0};e.children=[a]}return e}))},handleExpand:function(e,t){var a=this;if(e){if(this.expandedRowKeys.push(t.id),t.children.length>0&&!0===t.children[0].isLoading){var n=this.getQueryParams();n[this.pidField]=t.id,Object(l[\"c\"])(this.url.childList,n).then((function(e){e.success?e.result&&e.result.length>0?(t.children=a.getDataByResult(e.result),a.dataSource=h(a.dataSource)):(t.children=\"\",t.hasChildrenField=\"0\"):a.$message.warning(e.message)}))}}else{var i=this.expandedRowKeys.indexOf(t.id);i>=0&&this.expandedRowKeys.splice(i,1)}},initDictConfig:function(){},modalFormOk:function(e,t){e.id?(this.editOk(e,this.dataSource),this.dataSource=h(this.dataSource)):this.addOk(e,t)},editOk:function(e,t){if(t&&t.length>0)for(var a=0;a<t.length;a++){if(t[a].id==e.id){t[a]=e;break}this.editOk(e,t[a].children)}},addOk:function(){var e=u(o.a.mark((function e(t,a){var n,i,r,l,s,d;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t[this.pidField]){e.next=4;break}this.loadData(),e.next=32;break;case 4:this.expandedRowKeys=[],n=!0,i=!1,r=void 0,e.prev=9,l=a[Symbol.iterator]();case 11:if(n=(s=l.next()).done){e.next=18;break}return d=s.value,e.next=15,this.expandTreeNode(d);case 15:n=!0,e.next=11;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e[\"catch\"](9),i=!0,r=e.t0;case 24:e.prev=24,e.prev=25,n||null==l.return||l.return();case 27:if(e.prev=27,!i){e.next=30;break}throw r;case 30:return e.finish(27);case 31:return e.finish(24);case 32:case\"end\":return e.stop()}}),e,this,[[9,20,24,32],[25,,27,31]])})));function t(t,a){return e.apply(this,arguments)}return t}(),expandTreeNode:function(e){var t=this;return new Promise((function(a,n){t.getFormDataById(e,t.dataSource);var i=t.parentFormData;t.expandedRowKeys.push(e);var r=t.getQueryParams();r[t.pidField]=e,Object(l[\"c\"])(t.url.childList,r).then((function(e){e.success?e.result&&e.result.length>0?(i.children=t.getDataByResult(e.result),t.dataSource=h(t.dataSource),a()):(i.children=\"\",i.hasChildrenField=\"0\",n()):n()}))}))},getFormDataById:function(e,t){if(t&&t.length>0)for(var a=0;a<t.length;a++)t[a].id==e?this.parentFormData=t[a]:this.getFormDataById(e,t[a].children)},handleAddSub:function(e){this.subExpandedKeys=[],this.getExpandKeysByPid(e.id,this.dataSource,this.dataSource),this.$refs.modalForm.subExpandedKeys=this.subExpandedKeys,this.$refs.modalForm.title=\"添加子分类\",this.$refs.modalForm.edit({pid:e.id}),this.$refs.modalForm.disableSubmit=!1},handleDelete:function(e){var t=this,a=this;Object(l[\"a\"])(a.url.delete,{id:e.id}).then((function(n){if(n.success)if(e.pid&&\"0\"!=e.pid){var i={pid:e.pid};a.$message.success(n.message),a.subExpandedKeys=[],a.getExpandKeysByPid(e.pid,t.dataSource,t.dataSource),a.addOk(i,t.subExpandedKeys.reverse())}else a.loadData();else a.$message.warning(n.message)}))},getExpandKeysByPid:function(e,t,a){if(e&&t&&t.length>0)for(var n=0;n<t.length;n++)t[n].id==e?(this.subExpandedKeys.push(t[n].id),this.getExpandKeysByPid(t[n][\"pid\"],a,a)):this.getExpandKeysByPid(e,t[n].children,a)}}},v=m,g=(a(\"0380\"),a(\"2877\")),b=Object(g[\"a\"])(v,n,i,!1,null,\"173f0034\",null);t[\"default\"]=b.exports},f1cf:function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-modal\",{attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,destroyOnClose:!0,cancelText:\"关闭\"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a(\"a-spin\",{attrs:{spinning:e.confirmLoading}},[a(\"a-form\",{attrs:{form:e.form}},[a(\"a-form-item\",{attrs:{label:\"父级节点\",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a(\"j-tree-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"pid\",e.validatorRules.pid],expression:\"['pid', validatorRules.pid]\"}],ref:\"treeSelect\",attrs:{placeholder:\"请选择父级节点\",dict:\"sys_category,name,id\",pidField:\"pid\",pidValue:\"0\"}})],1),a(\"a-form-item\",{attrs:{label:\"分类名称\",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"name\",e.validatorRules.name],expression:\"[ 'name', validatorRules.name]\"}],attrs:{placeholder:\"请输入分类名称\"}})],1)],1)],1)],1)},i=[],r=a(\"0fea\"),o=a(\"88bc\"),l=a.n(o),s=a(\"b098\"),d={name:\"SysCategoryModal\",components:{JTreeSelect:s[\"default\"]},data:function(){return{form:this.$form.createForm(this),title:\"操作\",width:800,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{code:{rules:[{required:!0,message:\"请输入类型编码!\"},{validator:this.validateMyCode}]},pid:{},name:{rules:[{required:!0,message:\"请输入类型名称!\"}]}},url:{add:\"/sys/category/add\",edit:\"/sys/category/edit\",checkCode:\"/sys/category/checkCode\"},expandedRowKeys:[],pidField:\"pid\",subExpandedKeys:[]}},created:function(){},methods:{add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(l()(t.model,\"pid\",\"name\",\"code\"))}))},close:function(){this.$emit(\"close\"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,n){if(!a){t.confirmLoading=!0;var i=\"\",o=\"\";e.model.id?(i+=e.url.edit,o=\"put\"):(i+=e.url.add,o=\"post\");var l=Object.assign(e.model,n);Object(r[\"h\"])(i,l,o).then((function(e){e.success?(t.$message.success(e.message),t.submitSuccess(l)):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()}))}}))},handleCancel:function(){this.close()},popupCallback:function(e){this.form.setFieldsValue(l()(e,\"pid\",\"name\",\"code\"))},submitSuccess:function(e){if(e.id)this.$emit(\"ok\",e);else{var t=this.$refs.treeSelect.getCurrTreeData();this.expandedRowKeys=[],this.getExpandKeysByPid(e[this.pidField],t,t),e.pid&&0==this.expandedRowKeys.length&&(this.expandedRowKeys=this.subExpandedKeys),this.$emit(\"ok\",e,this.expandedRowKeys.reverse())}},getExpandKeysByPid:function(e,t,a){if(e&&t&&t.length>0)for(var n=0;n<t.length;n++)t[n].key==e?(this.expandedRowKeys.push(t[n].key),this.getExpandKeysByPid(t[n][\"parentId\"],a,a)):this.getExpandKeysByPid(e,t[n].children,a)},validateMyCode:function(e,t,a){var n={pid:this.form.getFieldValue(\"pid\"),code:t};Object(r[\"c\"])(this.url.checkCode,n).then((function(e){e.success?a():a(e.message)}))}}},c=d,u=a(\"2877\"),h=Object(u[\"a\"])(c,n,i,!1,null,null,null);t[\"default\"]=h.exports}}]);","extractedComments":[]}