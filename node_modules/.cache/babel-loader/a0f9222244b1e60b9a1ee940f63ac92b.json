{"remainingRequest":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\ideaworkspace\\jxc-front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\ideaworkspace\\jxc-front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ideaworkspace\\jxc-front-end\\src\\views\\erp\\finance\\modules\\OtherReceivableModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ideaworkspace\\jxc-front-end\\src\\views\\erp\\finance\\modules\\OtherReceivableModal.vue","mtime":1648374777625},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1648365135345},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1648365068269},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1648365135345},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1648364957239}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport pick from 'lodash.pick';\nimport { httpAction, putAction } from '@/api/manage';\nimport JDate from '@/components/jeecg/JDate';\nimport JUpload from '@/components/jeecg/JUpload';\nimport JDictSelectTag from \"@/components/dict/JDictSelectTag\";\nimport { getFormatDate } from \"../../utils/util\";\nexport default {\n  name: \"OtherReceivableModal\",\n  components: {\n    JDate: JDate,\n    JUpload: JUpload,\n    JDictSelectTag: JDictSelectTag\n  },\n  data: function data() {\n    return {\n      action: \"\",\n      title: \"操作\",\n      width: '1200px',\n      visible: false,\n      moreStatus: false,\n      form: this.$form.createForm(this),\n      model: {},\n      spans: {\n        labelCol1: {\n          span: 2\n        },\n        wrapperCol1: {\n          span: 22\n        },\n        labelCol2: {\n          span: 4\n        },\n        wrapperCol2: {\n          span: 20\n        },\n        labelCol3: {\n          span: 6\n        },\n        wrapperCol3: {\n          span: 18\n        },\n        labelCol6: {\n          span: 12\n        },\n        wrapperCol6: {\n          span: 12\n        }\n      },\n      confirmLoading: false,\n      validatorRules: {\n        sourceType: {\n          rules: []\n        },\n        sourceId: {\n          rules: []\n        },\n        sourceNo: {\n          rules: []\n        },\n        isAuto: {\n          rules: []\n        },\n        billNo: {\n          rules: [{\n            required: true,\n            message: '请输入单据编号!'\n          }]\n        },\n        billDate: {\n          rules: [{\n            required: true,\n            message: '请输入单据日期!'\n          }]\n        },\n        customerId: {\n          rules: [{\n            required: true,\n            message: '请输入客户!'\n          }]\n        },\n        isRubric: {\n          rules: []\n        },\n        amt: {\n          rules: [{\n            required: true,\n            message: '请输入金额!'\n          }]\n        },\n        checkedAmt: {\n          rules: []\n        },\n        attachment: {\n          rules: []\n        },\n        remark: {\n          rules: []\n        },\n        billProcStatus: {\n          rules: []\n        },\n        isApproved: {\n          rules: []\n        },\n        isClosed: {\n          rules: []\n        },\n        isVoided: {\n          rules: []\n        },\n        effectiveTime: {\n          rules: []\n        },\n        approverId: {\n          rules: []\n        },\n        flowId: {\n          rules: []\n        },\n        createTime: {\n          rules: []\n        },\n        createBy: {\n          rules: []\n        },\n        sysOrgCode: {\n          rules: []\n        },\n        updateTime: {\n          rules: []\n        },\n        updateBy: {\n          rules: []\n        }\n      },\n      url: {\n        add: \"/finance/finReceivable/add\",\n        edit: \"/finance/finReceivable/edit\",\n        approve: \"/finance/finReceivable/approve\"\n      }\n    };\n  },\n  computed: {\n    readOnly: function readOnly() {\n      return this.action !== \"add\" && this.action !== \"edit\";\n    }\n  },\n  methods: {\n    add: function add() {\n      this.model = {};\n      this.model.receivableType = '199';\n      this.model.isRubric = 0;\n      this.model.isAuto = 0; //处理状态：编辑中\n\n      this.model.billProcStatus = '12';\n      this.model.checkedAmt = 0; // 请求后台的填值规则接口地址\n\n      var url = '/sys/fillRule/executeRuleByCode/';\n      var ruleCode = 'payable_bill_no';\n      var that = this;\n      putAction(url + ruleCode, {}).then(function (res) {\n        // 执行成功，获取返回的值，并赋到页面上\n        if (res.success) {\n          that.$nextTick(function () {\n            that.form.setFieldsValue({\n              'billNo': res.result,\n              'billDate': getFormatDate()\n            });\n          });\n        }\n      });\n      this.edit(this.model);\n    },\n    edit: function edit(record) {\n      var _this = this;\n\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      this.$nextTick(function () {\n        _this.form.setFieldsValue(pick(_this.model, 'sourceType', 'sourceNo', 'sourceId', 'billNo', 'billDate', 'customerId', 'isRubric', 'amt', 'checkedAmt', 'attachment', 'remark', 'billProcStatus', 'approverId', 'flowId', 'isApproved', 'effectiveTime', 'isVoided', 'isClosed', 'sysOrgCode', 'createBy', 'createTime', 'updateBy', 'updateTime'));\n      });\n    },\n    close: function close() {\n      this.$emit('close');\n      this.visible = false;\n    },\n    popupCallback: function popupCallback(row) {\n      this.form.setFieldsValue(pick(row, 'sourceType', 'sourceNo', 'sourceId', 'billNo', 'billDate', 'customerId', 'isRubric', 'amt', 'checkedAmt', 'attachment', 'remark', 'billProcStatus', 'approverId', 'flowId', 'isApproved', 'effectiveTime', 'isVoided', 'isClosed', 'sysOrgCode', 'createBy', 'createTime', 'updateBy', 'updateTime'));\n    },\n    handleOk: function handleOk() {\n      var _this2 = this;\n\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          that.confirmLoading = true;\n          var httpurl = '';\n          var method = '';\n\n          if (!_this2.model.id) {\n            httpurl += _this2.url.add;\n            method = 'post';\n          } else {\n            httpurl += _this2.url.edit;\n            method = 'put';\n          }\n\n          var formData = Object.assign(_this2.model, values);\n          httpAction(httpurl, formData, method).then(function (res) {\n            if (res.success) {\n              that.$message.success(res.message);\n              that.$emit('ok');\n            } else {\n              that.$message.warning(res.message);\n            }\n          }).finally(function () {\n            that.confirmLoading = false;\n            that.close();\n          });\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    },\n    handleSave: function handleSave() {\n      this.handleOk();\n    },\n    handleSubmit: function handleSubmit() {\n      var _this3 = this;\n\n      //处理状态=编辑完成\n      this.form.setFieldsValue({\n        billProcStatus: '13'\n      }); //出错时要恢复billProcStatus为\"12\"，所以下面未直接调用handleSave()！\n\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          that.confirmLoading = true;\n          var httpurl = '';\n          var method = '';\n\n          if (!_this3.model.id) {\n            httpurl += _this3.url.add;\n            method = 'post';\n          } else {\n            httpurl += _this3.url.edit;\n            method = 'put';\n          }\n\n          var formData = Object.assign(_this3.model, values);\n          httpAction(httpurl, formData, method).then(function (res) {\n            if (res.success) {\n              that.$message.success(res.message);\n              that.$emit('ok');\n            } else {\n              //处理状态=编辑中\n              that.form.setFieldsValue({\n                billProcStatus: '12'\n              });\n              that.$message.warning(res.message);\n            }\n          }).finally(function () {\n            that.confirmLoading = false;\n            that.close();\n          });\n        }\n      });\n    },\n    handleApproved: function handleApproved() {\n      var that = this;\n      putAction(that.url.approve, {\n        id: that.model.id\n      }).then(function (res) {\n        if (res.success) {\n          that.$message.success(res.message);\n          that.$emit('ok');\n          that.close();\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["OtherReceivableModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <j-modal\r\n    :title=\"'其他应收 - ' + title\"\r\n    :width=\"width\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    :maskClosable=\"false\"\r\n    :keyboard=\"false\"\r\n    :forceRender=\"true\"\r\n    switchFullscreen\r\n    @cancel=\"handleCancel\">\r\n\r\n    <template slot=\"footer\">\r\n      <a-button v-if=\"action!=='detail'\" key=\"cancel\" @click=\"handleCancel\">取消</a-button>\r\n      <a-button v-if=\"!readOnly\" key=\"save\"   @click=\"handleSave\" type=\"primary\" :loading=\"confirmLoading\">保存</a-button>\r\n      <a-button v-if=\"!readOnly\" key=\"submit\" @click=\"handleSubmit\" type=\"primary\" :loading=\"confirmLoading\">提交</a-button>\r\n      <a-button v-if=\"action==='detail'\"  key=\"close\"  @click=\"handleCancel\" type=\"primary\">关闭</a-button>\r\n      <a-button v-if=\"action==='approve'\"  key=\"approved\"  @click=\"handleApproved\" type=\"primary\">审核通过</a-button>\r\n    </template>\r\n\r\n    <a-spin :spinning=\"confirmLoading\">\r\n      <a-form :form=\"form\">\r\n        <a-row>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"处理状态\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['billProcStatus', validatorRules.billProcStatus]\" :trigger-change=\"true\" dictCode=\"x_bill_proc_status\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"4\">\r\n            <a-form-item label=\"是否通过\" :labelCol=\"spans.labelCol6\" :wrapperCol=\"spans.wrapperCol6\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['isApproved', validatorRules.isApproved]\" :trigger-change=\"true\" dictCode=\"yn\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"4\">\r\n            <a-form-item label=\"是否关闭\" :labelCol=\"spans.labelCol6\" :wrapperCol=\"spans.wrapperCol6\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['isClosed', validatorRules.isClosed]\" :trigger-change=\"true\" dictCode=\"yn\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"4\">\r\n            <a-form-item label=\"是否作废\" :labelCol=\"spans.labelCol6\" :wrapperCol=\"spans.wrapperCol6\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['isVoided', validatorRules.isVoided]\" :trigger-change=\"true\" dictCode=\"yn\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"4\">\r\n            <a @click=\"()=> this.moreStatus = !this.moreStatus\" style=\"float: right; margin-top: 10px\">\r\n              {{ moreStatus ? '收起' : '展开' }}\r\n              <a-icon :type=\"moreStatus ? 'up' : 'down'\"/>\r\n            </a>\r\n          </a-col>\r\n        </a-row>\r\n        <a-row v-show=\"moreStatus\">\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"创建时间\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-date :readOnly=\"true\" v-decorator=\"[ 'createTime', validatorRules.createTime]\" :trigger-change=\"true\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"创建人\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['createBy', validatorRules.createBy]\" :trigger-change=\"true\" dictCode=\"sys_user,realname,username\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"创建部门\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['sysOrgCode', validatorRules.sysOrgCode]\" :trigger-change=\"true\" dictCode=\"sys_depart,depart_name,org_code\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"生效时间\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-date :readOnly=\"true\" v-decorator=\"[ 'effectiveTime', validatorRules.effectiveTime]\" :showTime=\"true\" :trigger-change=\"true\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"审核人\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['approverId', validatorRules.approverId]\" :trigger-change=\"true\" dictCode=\"sys_user,realname,username\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"流程\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <a-input :readOnly=\"true\" v-decorator=\"[ 'flowId', validatorRules.flowId]\" ></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"修改时间\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-date :readOnly=\"true\" v-decorator=\"[ 'updateTime', validatorRules.updateTime]\" :trigger-change=\"true\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"修改人\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled type=\"list\" v-decorator=\"['updateBy', validatorRules.updateBy]\" :trigger-change=\"true\" dictCode=\"sys_user,realname,username\" />\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n        <a-row>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"单据编号\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <a-input :readOnly=\"true\" v-decorator=\"[ 'billNo', validatorRules.billNo]\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"单据日期\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-date :readOnly=\"readOnly\" v-decorator=\"[ 'billDate', validatorRules.billDate]\" :trigger-change=\"true\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item  label=\"制单人\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag disabled  type=\"list\" v-decorator=\"['createBy', validatorRules.createBy]\" :trigger-change=\"true\" dictCode=\"sys_user,realname,username\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"客户\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag :disabled=\"readOnly\" type=\"list\" v-decorator=\"['customerId', validatorRules.customerId]\" :trigger-change=\"true\" dictCode=\"bas_customer,name,id\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"是否红字\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <j-dict-select-tag :disabled=\"readOnly\" type=\"list\" v-decorator=\"['isRubric', validatorRules.isRubric]\" :trigger-change=\"true\" dictCode=\"yn\" />\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\">\r\n            <a-form-item label=\"金额\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <a-input-number :disabled=\"readOnly\" v-decorator=\"['amt', validatorRules.amt]\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"8\" v-show=\"action==='detail'\">\r\n            <a-form-item label=\"已核销金额\" :labelCol=\"spans.labelCol3\" :wrapperCol=\"spans.wrapperCol3\">\r\n              <a-input-number disabled v-decorator=\"['checkedAmt', validatorRules.checkedAmt]\" style=\"width: 100%\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n        <a-row>\r\n          <a-col :span=\"24\">\r\n            <a-form-item label=\"备注\" :labelCol=\"spans.labelCol1\" :wrapperCol=\"spans.wrapperCol1\">\r\n              <a-textarea :readOnly=\"readOnly\" v-decorator=\"['remark', validatorRules.remark]\" rows=\"1\" autoSize></a-textarea>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :span=\"24\">\r\n            <a-form-item label=\"附件\" :labelCol=\"spans.labelCol1\" :wrapperCol=\"spans.wrapperCol1\">\r\n              <j-upload :disabled=\"readOnly\" v-decorator=\"['attachment', validatorRules.attachment]\" :trigger-change=\"true\"></j-upload>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n      </a-form>\r\n    </a-spin>\r\n  </j-modal>\r\n</template>\r\n\r\n<script>\r\n\r\n  import pick from 'lodash.pick'\r\n  import { httpAction, putAction } from '@/api/manage'\r\n  import JDate from '@/components/jeecg/JDate'\r\n  import JUpload from '@/components/jeecg/JUpload'\r\n  import JDictSelectTag from \"@/components/dict/JDictSelectTag\"\r\n  import {getFormatDate} from \"../../utils/util\";\r\n\r\n  export default {\r\n    name: \"OtherReceivableModal\",\r\n    components: {\r\n      JDate,\r\n      JUpload,\r\n      JDictSelectTag,\r\n    },\r\n    data () {\r\n      return {\r\n        action: \"\",\r\n        title:\"操作\",\r\n        width: '1200px',\r\n        visible: false,\r\n        moreStatus: false,\r\n        form: this.$form.createForm(this),\r\n        model: {},\r\n\r\n        spans: {\r\n          labelCol1: { span: 2 },\r\n          wrapperCol1: { span: 22 },\r\n          labelCol2: { span: 4 },\r\n          wrapperCol2: { span: 20 },\r\n          labelCol3: { span: 6 },\r\n          wrapperCol3: { span: 18 },\r\n          labelCol6: { span: 12 },\r\n          wrapperCol6: { span: 12 }\r\n        },\r\n\r\n        confirmLoading: false,\r\n        validatorRules: {\r\n          sourceType: {rules: []},\r\n          sourceId: {rules: []},\r\n          sourceNo:  {rules: []},\r\n          isAuto: {rules: []},\r\n          billNo: {rules: [\r\n              {required: true, message: '请输入单据编号!'},\r\n            ]},\r\n          billDate: {rules: [\r\n              {required: true, message: '请输入单据日期!'},\r\n            ]},\r\n          customerId: {rules: [\r\n              {required: true, message: '请输入客户!'},\r\n            ]},\r\n          isRubric: {rules: []},\r\n          amt: {rules: [\r\n              {required: true, message: '请输入金额!'},\r\n            ]},\r\n          checkedAmt:  {rules: []},\r\n          attachment: {rules: []},\r\n          remark: {rules: []},\r\n          billProcStatus: {rules: []},\r\n          isApproved: {rules: []},\r\n          isClosed: {rules: []},\r\n          isVoided: {rules: []},\r\n          effectiveTime: {rules: []},\r\n          approverId: {rules: []},\r\n          flowId: {rules: []},\r\n          createTime: {rules: []},\r\n          createBy: {rules: []},\r\n          sysOrgCode: {rules: []},\r\n          updateTime: {rules: []},\r\n          updateBy: {rules: []},\r\n        },\r\n        url: {\r\n          add: \"/finance/finReceivable/add\",\r\n          edit: \"/finance/finReceivable/edit\",\r\n          approve: \"/finance/finReceivable/approve\",\r\n        }\r\n      }\r\n    },\r\n\r\n    computed: {\r\n      readOnly: function() {\r\n        return this.action !== \"add\" && this.action !== \"edit\"\r\n      }\r\n    },\r\n\r\n    methods: {\r\n      add () {\r\n        this.model = {}\r\n        this.model.receivableType = '199'\r\n        this.model.isRubric = 0;\r\n        this.model.isAuto = 0\r\n        //处理状态：编辑中\r\n        this.model.billProcStatus = '12'\r\n        this.model.checkedAmt = 0;\r\n\r\n        // 请求后台的填值规则接口地址\r\n        const url = '/sys/fillRule/executeRuleByCode/'\r\n        const ruleCode = 'payable_bill_no'\r\n        const that = this\r\n        putAction(url + ruleCode, {}).then(res => {\r\n          // 执行成功，获取返回的值，并赋到页面上\r\n          if (res.success) {\r\n            that.$nextTick(() => {\r\n              that.form.setFieldsValue({'billNo':res.result, 'billDate':getFormatDate()})\r\n            })\r\n          }\r\n        })\r\n\r\n        this.edit(this.model);\r\n      },\r\n      edit (record) {\r\n        this.form.resetFields();\r\n        this.model = Object.assign({}, record);\r\n        this.visible = true;\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model,'sourceType','sourceNo','sourceId','billNo','billDate','customerId','isRubric','amt','checkedAmt','attachment','remark','billProcStatus','approverId','flowId','isApproved','effectiveTime','isVoided','isClosed','sysOrgCode','createBy','createTime','updateBy','updateTime'))\r\n        })\r\n      },\r\n      close () {\r\n        this.$emit('close');\r\n        this.visible = false;\r\n      },\r\n      popupCallback(row){\r\n        this.form.setFieldsValue(pick(row,'sourceType','sourceNo','sourceId','billNo','billDate','customerId','isRubric','amt','checkedAmt','attachment','remark','billProcStatus','approverId','flowId','isApproved','effectiveTime','isVoided','isClosed','sysOrgCode','createBy','createTime','updateBy','updateTime'))\r\n      },\r\n\r\n      handleOk () {\r\n        const that = this;\r\n        // 触发表单验证\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            that.confirmLoading = true;\r\n            let httpurl = '';\r\n            let method = '';\r\n            if(!this.model.id){\r\n              httpurl+=this.url.add;\r\n              method = 'post';\r\n            }else{\r\n              httpurl+=this.url.edit;\r\n              method = 'put';\r\n            }\r\n            let formData = Object.assign(this.model, values);\r\n            httpAction(httpurl,formData,method).then((res)=>{\r\n              if(res.success){\r\n                that.$message.success(res.message);\r\n                that.$emit('ok');\r\n              }else{\r\n                that.$message.warning(res.message);\r\n              }\r\n            }).finally(() => {\r\n              that.confirmLoading = false;\r\n              that.close();\r\n            })\r\n          }\r\n        })\r\n      },\r\n      handleCancel () {\r\n        this.close()\r\n      },\r\n\r\n      handleSave() {\r\n        this.handleOk()\r\n      },\r\n\r\n      handleSubmit() {\r\n        //处理状态=编辑完成\r\n        this.form.setFieldsValue({billProcStatus: '13'});\r\n\r\n        //出错时要恢复billProcStatus为\"12\"，所以下面未直接调用handleSave()！\r\n        const that = this;\r\n        // 触发表单验证\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            that.confirmLoading = true;\r\n            let httpurl = '';\r\n            let method = '';\r\n            if(!this.model.id){\r\n              httpurl+=this.url.add;\r\n              method = 'post';\r\n            }else{\r\n              httpurl+=this.url.edit;\r\n              method = 'put';\r\n            }\r\n            let formData = Object.assign(this.model, values);\r\n            httpAction(httpurl,formData,method).then((res)=>{\r\n              if(res.success){\r\n                that.$message.success(res.message);\r\n                that.$emit('ok');\r\n              }else{\r\n                //处理状态=编辑中\r\n                that.form.setFieldsValue({billProcStatus:'12'});\r\n                that.$message.warning(res.message);\r\n              }\r\n            }).finally(() => {\r\n              that.confirmLoading = false;\r\n              that.close();\r\n            })\r\n          }\r\n        })\r\n      },\r\n\r\n      handleApproved() {\r\n        const that = this;\r\n        putAction(that.url.approve, {id: that.model.id}).then((res) => {\r\n          if (res.success) {\r\n            that.$message.success(res.message);\r\n            that.$emit('ok')\r\n            that.close()\r\n          } else {\r\n            that.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .ant-row.ant-form-item {\r\n    margin-bottom: 12px;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/erp/finance/modules"}]}