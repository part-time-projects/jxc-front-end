{"remainingRequest":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\thread-loader\\dist\\cjs.js!D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\ideaworkspace\\jxc-front-end\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\ideaworkspace\\jxc-front-end\\src\\utils\\JEditableTableUtil.js","dependencies":[{"path":"D:\\ideaworkspace\\jxc-front-end\\src\\utils\\JEditableTableUtil.js","mtime":1648374777582},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1648365135345},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1648365139913},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1648365068269},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1648365119872}],"contextDependencies":[],"result":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar FormTypes = {\n  normal: 'normal',\n  input: 'input',\n  inputNumber: 'inputNumber',\n  checkbox: 'checkbox',\n  select: 'select',\n  date: 'date',\n  datetime: 'datetime',\n  upload: 'upload',\n  file: 'file',\n  image: 'image',\n  popup: 'popup',\n  list_multi: \"list_multi\",\n  sel_search: \"sel_search\",\n  radio: 'radio',\n  checkbox_meta: \"checkbox_meta\",\n  input_pop: 'input_pop',\n  slot: 'slot',\n  hidden: 'hidden'\n};\nvar VALIDATE_NO_PASSED = Symbol();\nexport { FormTypes, VALIDATE_NO_PASSED };\n/**\r\n * 获取指定的 $refs 对象\r\n * 有时候可能会遇到组件未挂载到页面中的情况，导致无法获取 $refs 中的某个对象\r\n * 这个方法可以等待挂载完成之后再返回 $refs 的对象，避免报错\r\n * @author sunjianlei\r\n **/\n\nexport function getRefPromise(vm, name) {\n  return new Promise(function (resolve) {\n    (function next() {\n      var ref = vm.$refs[name];\n\n      if (ref) {\n        resolve(ref);\n      } else {\n        setTimeout(function () {\n          next();\n        }, 10);\n      }\n    })();\n  });\n}\n/**\r\n * 一次性验证主表单和所有的次表单\r\n * @param form 主表单 form 对象\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @returns {Promise<any>}\r\n * @author sunjianlei\r\n */\n\nexport function validateFormAndTables(form, cases) {\n  if (!(form && typeof form.validateFields === 'function')) {\n    throw \"form \\u53C2\\u6570\\u9700\\u8981\\u7684\\u662F\\u4E00\\u4E2Aform\\u5BF9\\u8C61\\uFF0C\\u800C\\u4F20\\u5165\\u7684\\u5374\\u662F\".concat(_typeof(form));\n  }\n\n  var options = {};\n  return new Promise(function (resolve, reject) {\n    // 验证主表表单\n    form.validateFields(function (err, values) {\n      err ? reject({\n        error: VALIDATE_NO_PASSED\n      }) : resolve(values);\n    });\n  }).then(function (values) {\n    Object.assign(options, {\n      formValue: values\n    }); // 验证所有子表的表单\n\n    return validateTables(cases);\n  }).then(function (all) {\n    Object.assign(options, {\n      tablesValue: all\n    });\n    return Promise.resolve(options);\n  }).catch(function (error) {\n    return Promise.reject(error);\n  });\n}\n/**\r\n * 验证并获取一个或多个表格的所有值\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @param deleteTempId 是否删除临时ID，如果设为true，行编辑就不返回新增行的ID，ID需要后台生成\r\n * @author sunjianlei\r\n */\n\nexport function validateTables(cases, deleteTempId) {\n  if (!(cases instanceof Array)) {\n    throw \"'validateTables'\\u51FD\\u6570\\u7684'cases'\\u53C2\\u6570\\u9700\\u8981\\u7684\\u662F\\u4E00\\u4E2A\\u6570\\u7EC4\\uFF0C\\u800C\\u4F20\\u5165\\u7684\\u5374\\u662F\".concat(_typeof(cases));\n  }\n\n  return new Promise(function (resolve, reject) {\n    var tables = [];\n    var index = 0;\n\n    if (!cases || cases.length == 0) {\n      resolve();\n    }\n\n    (function next() {\n      var vm = cases[index];\n      vm.getAll(true, deleteTempId).then(function (all) {\n        tables[index] = all; // 判断校验是否全部完成，完成返回成功，否则继续进行下一步校验\n\n        if (++index === cases.length) {\n          resolve(tables);\n        } else next();\n      }, function (error) {\n        // 出现未验证通过的表单，不再进行下一步校验，直接返回失败并跳转到该表格\n        if (error === VALIDATE_NO_PASSED) {\n          reject({\n            error: VALIDATE_NO_PASSED,\n            index: index\n          });\n        }\n\n        reject(error);\n      });\n    })();\n  });\n}",null]}