{"remainingRequest":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\thread-loader\\dist\\cjs.js!D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\ideaworkspace\\jxc-front-end\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\ideaworkspace\\jxc-front-end\\src\\views\\erp\\mixins\\billModalMixin.js","dependencies":[{"path":"D:\\ideaworkspace\\jxc-front-end\\src\\views\\erp\\mixins\\billModalMixin.js","mtime":1648374777635},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1648365135345},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1648365139913},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1648365068269},{"path":"D:\\ideaworkspace\\jxc-front-end\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1648365119872}],"contextDependencies":[],"result":["import { VALIDATE_NO_PASSED, validateFormAndTables } from '@/utils/JEditableTableUtil';\nimport { putAction } from '@/api/manage';\nexport var billModalMixin = {\n  data: function data() {\n    return {\n      action: '',\n      spans: {\n        labelCol1: {\n          span: 2\n        },\n        wrapperCol1: {\n          span: 22\n        },\n        //1_5: 分为1.5列（相当于占了2/3）\n        labelCol1_5: {\n          span: 3\n        },\n        wrapperCol1_5: {\n          span: 21\n        },\n        labelCol2: {\n          span: 4\n        },\n        wrapperCol2: {\n          span: 20\n        },\n        labelCol3: {\n          span: 6\n        },\n        wrapperCol3: {\n          span: 18\n        },\n        labelCol6: {\n          span: 12\n        },\n        wrapperCol6: {\n          span: 12\n        }\n      }\n    };\n  },\n  computed: {\n    readOnly: function readOnly() {\n      return this.action !== \"add\" && this.action !== \"edit\";\n    }\n  },\n  methods: {\n    onEntryAdded: function onEntryAdded(event) {\n      var row = event.row,\n          target = event.target;\n\n      var _target$getValuesSync = target.getValuesSync({\n        validate: false\n      }),\n          values = _target$getValuesSync.values;\n\n      var maxEntryNo = 0;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var val = _step.value;\n          var entryNo = Number(val['entryNo']);\n          if (!isNaN(entryNo) && entryNo > maxEntryNo) maxEntryNo = entryNo;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      maxEntryNo += this.entryNoStep || 10;\n      target.setValues([{\n        rowKey: row.id,\n        values: {\n          entryNo: maxEntryNo\n        }\n      }]);\n    },\n    handleSave: function handleSave() {\n      this.handleOk();\n    },\n    handleSubmit: function handleSubmit() {\n      var _this = this;\n\n      //处理状态=编辑完成\n      this.form.setFieldsValue({\n        billProcStatus: '13'\n      }); //出错时要恢复billProcStatus为\"12\"，所以下面未直接调用handleSave()！\n\n      /** 触发表单验证 */\n\n      this.getAllTable().then(function (tables) {\n        /** 一次性验证主表和所有的次表 */\n        return validateFormAndTables(_this.form, tables);\n      }).then(function (allValues) {\n        if (typeof _this.classifyIntoFormData !== 'function') {\n          throw _this.throwNotFunction('classifyIntoFormData');\n        }\n\n        var formData = _this.classifyIntoFormData(allValues); // 发起请求\n\n\n        return _this.request(formData);\n      }).catch(function (e) {\n        //处理状态=编辑中\n        _this.form.setFieldsValue({\n          billProcStatus: '12'\n        });\n\n        if (e.error === VALIDATE_NO_PASSED) {\n          // 如果有未通过表单验证的子表，就自动跳转到它所在的tab\n          _this.activeKey = e.index == null ? _this.activeKey : _this.refKeys[e.index];\n        } else {\n          console.error(e);\n        }\n      });\n    },\n    handleApproved: function handleApproved() {\n      var that = this;\n      putAction(that.url.approve, {\n        id: that.model.id\n      }).then(function (res) {\n        if (res.success) {\n          that.$message.success(res.message);\n          that.$emit('ok');\n          that.close();\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    }\n  }\n};",null]}